---
title: "[AWS] CloudFront란?"
excerpt: "AWS CloudFront란? CloudFront의 특징은?"
date: 2024-11-15
last_modified_at: 2024-11-16
categories:
  - infra
tags:
  - aws
---

## A. Question

AWS CloudFront의 개념과 특징에는 어떤 것들이 있는가?

## B. Answer

`AWS CloudFront`는 Amazon Web Services에서 제공하는 **콘텐츠 전송 네트워크(CDN: Content Delivery Network)** 서비스이다. 이를 통해 웹 콘텐츠(정적 및 동적 웹사이트, 동영상 스트리밍, API 등)를 전 세계 사용자에게 더 빠르고 안전하게 전송할 수 있다. CloudFront는 콘텐츠를 사용자와 가까운 물리적 위치에 있는 엣지 로케이션(Edge Location)에 캐싱하여 전송 속도를 높이고 지연 시간을 줄여준다.

### 1. 전 세계 엣지 로케이션

* CloudFront는 전 세계 수백 개의 엣지 로케이션을 통해 콘텐츠를 제공한다. 사용자의 요청이 가장 가까운 엣지 로케이션으로 전달되기 때문에 콘텐츠 전송 속도가 향상된다.
* 엣지 로케이션은 네트워크 혼잡을 줄이고 전송 시간을 단축시켜 사용자 경험을 개선한다.
* 스트리밍 서비스: 비디오 스트리밍 플랫폼은 CloudFront의 엣지 로케이션을 통해, 사용자에게 빠르고 매끄러운 스트리밍 경험을 제공한다. 전 세계의 사용자가 같은 동영상을 요청할 경우, 해당 동영상은 엣지 로케이션에 캐싱되어 더 빠르게 전달된다.
* 웹사이트: 글로벌 이커머스 사이트는 상품 이미지, CSS, JavaScript 파일 등을 엣지 로케이션에 캐싱하여 전 세계 고객에게 빠른 페이지 로딩 속도를 제공한다.

### 2. 정적 및 동적 컨텐츠 지원

* AWS CloudFront는 정적 콘텐츠와 동적 콘텐츠를 모두 지원하는 CDN이다. 이를 통해 웹 애플리케이션의 다양한 유형의 콘텐츠를 사용자에게 빠르고 안정적으로 제공할 수 있다.

(1) 정적 콘텐츠 지원

* 정적 콘텐츠는 변하지 않고 동일한 상태로 사용자에게 전달되는 데이터이다. 여기에는 HTML, CSS, JavaScript 파일, 이미지, 동영상, 문서 파일 등이 포함된다.
* CloudFront는 정적 콘텐츠를 엣지 로케이션에 캐싱하여 사용자 요청 시 즉각적으로 제공할 수 있다. 이 캐싱 덕분에 원본 서버에 대한 요청 수가 감소하며, 페이지 로딩 속도가 크게 향상된다.
* 예를 들어, 웹사이트의 로고 이미지나 스타일시트는 캐싱된 정적 콘텐츠로써, 반복적인 요청에도 빠르게 제공된다.

(2) 동적 콘텐츠 지원

* 동적 콘텐츠는 사용자 입력, 데이터베이스 조회, API 호출 등과 같이 실시간으로 생성되거나 변경되는 데이터이다. 이는 사용자의 요청에 따라 다르게 표시될 수 있는 데이터이다.
* CloudFront는 동적 콘텐츠도 최적화된 경로를 통해 전달함으로써 성능을 높인다. 동적 콘텐츠의 경우, CloudFront는 사용자와 원본 서버 사이에서 최적의 네트워크 경로를 선택하여 지연 시간을 최소화한다.
* CloudFront는 프록시 역할을 하여 사용자 요청을 원본 서버로 전달하고, 원본 서버의 응답을 다시 사용자에게 반환한다. 이 과정에서 전송 지연을 줄이고 전반적인 네트워크 성능을 향상시킨다.

(3) 정적 및 동적 콘텐츠를 함께 사용한 예시
* 이커머스 웹사이트: CloudFront는 상품 이미지, 자바스크립트 파일 등과 같은 정적 콘텐츠를 캐싱하여 빠르게 제공하는 한편, 사용자가 검색창에 입력하거나 장바구니에 물건을 추가할 때 생성되는 동적 콘텐츠도 효율적으로 전달할 수 있다.
* 뉴스 포털 사이트: 자주 업데이트되는 뉴스 기사 리스트는 동적 콘텐츠로, CloudFront는 이를 최신 상태로 유지하면서도 빠르게 로딩할 수 있도록 지원한다. 동시에, 사이트 로고나 기본 템플릿과 같은 정적 콘텐츠는 캐싱되어 속도와 성능을 높인다.

(4) 콘텐츠 최적화 기능
* 지능형 경로 최적화: CloudFront는 최적의 경로를 통해 동적 콘텐츠를 전달하여 네트워크 지연을 최소화한다. 사용자의 지리적 위치와 엣지 로케이션 간의 최적 경로를 선택하여 데이터 전송 속도를 높인다.
* TTL(Time to Live) 설정: 정적 콘텐츠의 캐싱 지속 시간을 설정해 콘텐츠의 업데이트 주기를 관리할 수 있다. 이를 통해 자주 변경되는 콘텐츠는 더 자주 갱신하고, 자주 변경되지 않는 콘텐츠는 장시간 캐싱할 수 있다.

(5) 동적 콘텐츠 가속화 방법

* CloudFront는 HTTP/2와 웹소켓을 지원하여, 동적 콘텐츠의 데이터 전송 효율을 높인다. HTTP/2는 멀티플렉싱과 헤더 압축을 통해 다중 요청을 한 번에 처리할 수 있어, 동적 페이지 로딩이 더 빠르다.
* `Lambda@Egde`를 사용하여 엣지에서 코드 실행이 가능하므로, 사용자 요청에 따라 콘텐츠를 실시간으로 조정하거나 사용자 맞춤화를 수행할 수 있다. 예를 들어, 사용자 위치에 따라 동적 콘텐츠를 조정하여 로컬화된 데이터를 제공할 수 있다.

### 3. 보안 기능

* CloudFront는 `Amazon Shield`와 통합되어 DDoS(Distributed Denial of Service) 공격에 대한 보호 기능을 기본으로 제공한다. DDos 공격은 다수의 요청을 통해 서버를 과부하 상태로 만들어 서비스를 중단시키려는 시도로, CloudFront는 엣지 로케이션에서 트래픽을 분산시켜 과부하를 방지하고, 악의적인 트래픽을 필터링해 원본 서버의 안전성을 유지한다.
* `AWS WAF(Web Application Firewall)`은 웹 애플리케이션 방화벽으로, CloudFront와 통합되어 웹 애플리케이션의 보안을 강화할 수 있다. 이를 통해 특정 IP Address 차단 및 허용, 요청 필터링, 사용자 정의 보안 규칙을 설정할 수 있다.
* `SSL/TLS` 암호화는 데이터가 전송 중에 제3자에 의해 가로채거나 변조되지 않도록 보호한다. CloudFront는 HTTPS 프로토콜을 통해 데이터를 암호화하여 사용자와 엣지 로케이션 간의 안전한 데이터 전송을 보장한다.
  * HTTPS 지원: 웹사이트가 HTTPS를 지원하도록 설정하면, CloudFront는 SSL/TLS 인증서를 사용해 암호화된 연결을 유지하고 데이터의 기밀성을 보장한다.
  * 맞춤형 인증서: CloudFront는 `AWS Certificate Manager(ACM)`를 통해 무료 SSL/TLS 인증서를 제공하거나, 사용자 고유의 인증서를 사용할 수도 있다.

### 4. 원본 서버 설정

* CloudFront는 Amazon S3 버킷, HTTP 서버, Elastic Load Balancer, AWS Lambda@Edge, EC2 인스턴스 등 다양한 원본 서버와 함께 사용할 수 있다.
* 예를 들어, S3에 저장된 정적 파일을 CloudFront로 제공하여 데이터 전송 속도를 높이고 S3의 트래픽 부담을 줄일 수 있다.
* CloudFront는 여러 원본 서버를 동시에 설정할 수 있어 복합적인 콘텐츠 제공 전략을 지원한다. 캐싱 동작(Behaviors)을 통해 요청 경로별로 원본 서버를 지정하면, 정적 콘텐츠는 S3 버킷에서, 동적 콘텐츠는 EC2 인스턴스나 다른 HTTP 서버에서 제공할 수 있다. 이를 통해 원본 서버의 부하를 줄이고 성능을 최적화하며 사용자 경험을 개선할 수 있다.

### 5. 캐싱 및 콘텐츠 업데이트 처리

* CloudFront는 콘텐츠를 엣지 로케이션에 일정 기간 동안 캐싱하여 사용자에게 더 빠르게 제공할 수 있다. 이를 통해 원본 서버로의 요청 빈도를 줄이고, 반복적인 콘텐츠 요청에 대한 응답 시간을 단축할 수 있다. 캐싱된 콘텐츠는 사용자와 가까운 엣지 로케이션에서 제공되어 전송 지연을 줄이고 성능을 향상시킨다.

* AWS CloudFront는 콘텐츠 URL을 기준으로 캐싱을 수행하므로, 동일한 URL을 가진 콘텐츠가 변경되더라도 기본적으로 이전에 캐싱된 버전을 제공하게 된다. 이는 URL을 기반으로 콘텐츠를 식별하는 CloudFront의 캐싱 메커니즘 때문이다. 따라서 콘텐츠가 변경되었음을 인식시키기 위해서는 추가적인 설정과 조치가 필요하다.

(1) 캐시 무효화(Invalidation)

* 캐시된 콘텐츠를 강제로 갱신하려면 CloudFront의 캐시 무효화 기능을 사용해야 한다. 특정 URL의 캐싱된 콘텐츠를 무효화하면, CloudFront는 다음 요청 시 원본 서버에서 새 콘텐츠를 가져온다.
* 예시: AWS Management Console이나 AWS CLI를 사용해 무효화 요청을 생성할 수 있다.

(2) 버전 관리

* 콘텐츠 URL에 버전 번호나 쿼리 문자열을 추가하여 변경된 콘텐츠를 CloudFront가 인식하도록 할 수 있다. URL이 변경되면 CloudFront는 이를 새로운 콘텐츠로 간주하고 원본 서버에서 콘텐츠를 가져온다.
* 예시: `example.com/style.css` 대신 `example.com/style.css?v=2.0`과 같이 URL에 버전 정보를 추가.

(3) TTL(Time to Live) 설정

* 콘텐츠의 캐싱 주기를 조절하려면 TTL 설정을 사용한다. 짧은 TTL을 설정하면 콘텐츠가 더 자주 갱신된다. TTL이 만료되면 CloudFront는 원본 서버에 새 콘텐츠가 있는지 확인하고 갱신된 콘텐츠를 가져온다.
* 짧은 TTL은 콘텐츠의 갱신 빈도를 높일 수 있지만, 원본 서버에 대한 요청이 증가할 수 있다.

(4) Cache-Control 헤더 사용

* Cache-Control 헤더를 통해 원본 서버에서 제공되는 콘텐츠의 캐싱 동작을 제어할 수 있다. `Cache-Control: no-cache`를 설정하면 CloudFront는 매번 원본 서버에 콘텐츠 변경 여부를 확인하고 필요 시 새로운 콘텐츠를 가져온다.
* 예시: `Cache-Control: no-cache` 또는 `Cache-Control: max-age=0` 사용.

### 6. Lambda@Edge

* `Lambda@Edge`는 AWS CloudFront와 통합하여 사용할 수 있는 강력한 기능으로, 엣지 로케이션에서 코드를 실행하여 사용자 요청과 응답을 실시간으로 처리하고 사용자 맞춤화를 제공한다. 이를 통해 글로벌 사용자에게 지리적으로 가까운 곳에서 코드를 실행함으로써 지연 시간을 최소화하고 선응을 최적화할 수 있다.

(1) 사용자 맞춤화

* `Lambda@Edge`는 사용자 요청 시점에서 코드를 실행하여 맞춤형 콘텐츠 제공이 가능하다. 예를 들어, 사용자의 위치(지역, 국가)에 따라 다국어 페이지를 제공하거나, 시간대에 따른 맞춤형 메시지를 보여줄 수 있다.
* 예시: 사용자가 미국에서 접속하면 미국판 웹사이트를, 유럽에서 접속하면 유럽판 웹사이트를 제공하는 기능.

(2) A/B 테스트

* `Lambda@Edge`는 사용자 요청을 처리할 때 코드에서 분기 로직을 사용해 A/B 테스트를 실행할 수 있다. 이를 통해 서로 다른 버전의 콘텐츠를 다양한 사용자 그룹에 제공하고, 각 버전의 성능을 비교할 수 있다.
* 예시: 한 사용자 그룹에는 기존 디자인의 웹페이지를, 다른 사용자 그룹에는 새로운 디자인의 웹페이지를 제공하여 성능이나 사용자 반응을 테스트.

(3) 보안 및 인증

* `Lambda@Edge`는 콘텐츠 요청 시 사용자 인증 및 보안 검사를 수행할 수 있다. JWT 토큰 검증이나 사용자 권한 확인과 같은 인증 절차를 코드로 작성하여 엣지에서 실행할 수 있어, 원본 서버에 도달하기 전에 보안 점검을 완료할 수 있다.
* 예시: 사용자가 요청 시 특정 인증 토큰을 포함해야 하며, 이를 엣지 로케이션에서 검증한 후 적합한 경우에만 요청을 원본 서버로 전달.

(4) HTTP 헤더 및 응답 수정

* `Lambda@Edge`는 요청과 응답의 HTTP 헤더를 동적으로 수정할 수 있어, 보안 헤더 추가나 쿠키 값 변경 등을 통해 콘텐츠를 보다 맞춤화하거나 보안을 강화할 수 있다.
* 예시: `Content-Security-Policy` 헤더를 응답에 추가하거나, 사용자 요청에서 특정 쿠키 값을 검사하여 조건에 맞는 응답을 반환.

(5) SEO 및 리디렉션 처리

* 사용자 요청에 따라 URL을 동적으로 리디렉션하거나, SEO를 위한 URL 재작성(rewriting)을 수행할 수 있다.
* 예시: 특정 경로로 들어온 사용자를 다른 경로로 리디렉션하거나, 마케팅 캠페인에 따라 트래킹 파라미터를 추가해 페이지를 제공.

## C. Reference

* [AWS - CloudFront](https://aws.amazon.com/ko/cloudfront/)
